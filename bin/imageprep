#!/usr/bin/env ruby

require 'rubygems'
require 'bundler/setup'
require 'yaml'
require 'pp'

require_relative '../lib/imageprep/imagemanips'
require_relative '../lib/imageprep/options'

opts = ImagePrep::Options.new(ARGV)

imgs_yaml = Array.new

opts.images_to_load.each { |imageFileName|
	puts "Processing #{imageFileName}"
	im = ImagePrep::ImageManips.new(imageFileName, opts.outDir)
	im.copyOriginal
	im.generateSized

	imgs_yaml.push(im.generateYamlMeta)
}

imgs_yaml.each { |yaml|
	metadata = YAML.load_file(yaml)
	puts "{% photo2 http://media.eick.us/#{metadata["path"]} \"#{metadata["headline"]}\" %}"
}